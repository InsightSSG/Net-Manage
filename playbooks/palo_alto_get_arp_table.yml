- name: Palo Alto Get ARP Table
  hosts: "{{ host_group }}"
  connection: local
  gather_facts: no

  tasks:
    - name: get arp table on remote devices
      paloaltonetworks.panos.panos_op:
        cmd: <show><arp><entry name='all'/></arp></show>
        cmd_is_xml: True  # Required when 'all' is in the command. See:
                          # https://github.com/PaloAltoNetworks/pan-os-python/issues/122
        provider:
          username: "{{ user }}"
          ip_address: "{{ ansible_host }}"
          password: "{{ password }}"
      delegate_to: localhost
      vars:
        ansible_command_timeout: "{{ ansible_timeout | default('240') }}"